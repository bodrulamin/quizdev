"use strict";(self.webpackChunktestspeedsheet=self.webpackChunktestspeedsheet||[]).push([[766],{3766:(M,c,r)=>{r.r(c),r.d(c,{ExamSchedulingModule:()=>U});var m=r(28),l=r(95),h=r(6097);class d{}var e=r(9291),p=r(5219),u=r(1108);const _=u._+"/get-exam-question-list-for-scheduling",y=u._+"/update-exam-schedule";var Z=r(3792);let D=(()=>{class o extends Z.b{constructor(){super()}searchQuestion(t){return this.http.post(_,t)}saveSchedule(t){return this.http.post(y,t)}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var L=r(6792),C=r(6814),v=r(2352),f=r(707),S=r(5431),E=r(3506),T=r(1423);function F(o,A){1&o&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Subject"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Date"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Start Time"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"End Time"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Quiz Password"),e.qZA(),e.TgZ(11,"th",18),e._uU(12,"Action"),e.qZA()())}function b(o,A){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"p-calendar",19),e.NdJ("ngModelChange",function(a){const s=e.CHM(t).$implicit;return e.KtG(s.examDate=a)}),e.qZA()(),e.TgZ(5,"td")(6,"p-calendar",20),e.NdJ("ngModelChange",function(a){const s=e.CHM(t).$implicit;return e.KtG(s.examStartsAt=a)}),e.qZA()(),e.TgZ(7,"td")(8,"p-calendar",21),e.NdJ("ngModelChange",function(){const i=e.CHM(t).$implicit;return e.KtG(i.invalidEndDate=!1)})("ngModelChange",function(a){const s=e.CHM(t).$implicit;return e.KtG(s.examEndsAt=a)}),e.qZA()(),e.TgZ(9,"td")(10,"p-password",22),e.NdJ("ngModelChange",function(a){const s=e.CHM(t).$implicit;return e.KtG(s.quizPwd=a)}),e.qZA()(),e.TgZ(11,"td",18)(12,"p-button",23),e.NdJ("onClick",function(){const i=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.save(i))}),e.qZA()(),e._UZ(13,"td"),e.qZA()}if(2&o){const t=A.$implicit;e.xp6(2),e.Oqu(t.subjectName),e.xp6(2),e.Q6J("ngModel",t.examDate)("showIcon",!0),e.xp6(2),e.Q6J("ngModel",t.examStartsAt)("timeOnly",!0),e.xp6(2),e.Tol(t.invalidEndDate?"ng-invalid ng-dirty":""),e.Q6J("ngModel",t.examEndsAt)("timeOnly",!0),e.xp6(2),e.Q6J("ngModel",t.quizPwd)("feedback",!1)("toggleMask",!0),e.xp6(2),e.Q6J("rounded",!0)("text",!0)}}const J=function(){return{"min-width":"50rem"}},Y=[{path:"",component:(()=>{class o extends h.H{constructor(t,n,a,i,s,O,N){super(),this.router=t,this.activatedRoute=n,this.messageService=a,this.ExamSchedulingService=i,this.adminService=s,this.formBuilder=O,this.datePipe=N,this.examLevelOptions=[],this.sessionOptions=[],this.yearOptions=[],this.required_field={examLevel:"Exam Level",session:"Session",year:"Year"},this.examList=[],this.invalidEndDate=!0,this.generateMinMaxYear(),this.prepareCreateQuestionForm(),this.fetchConfiguration()}generateMinMaxYear(){let t=new Date;this.minDate=t,this.minDate.setFullYear(t.getFullYear()-1),this.maxDate=new Date,this.maxDate.setFullYear(t.getFullYear()+5)}prepareCreateQuestionForm(){this.examSearchForm=this.formBuilder.group({examLevel:[null,l.kI.required],session:[null,l.kI.required],year:[null,[l.kI.required]]})}searchExams(){this.formInvalid()||this.ExamSchedulingService.searchQuestion(this.examSearchForm.value).subscribe(t=>{t.result&&(this.examList=t.data,this.examList.forEach(n=>{n.examDate=n.examDate?new Date(n.examDate):n.examDate,n.examStartsAt=n.examStartsAt?new Date(n.examStartsAt):n.examStartsAt,n.examEndsAt=n.examEndsAt?new Date(n.examEndsAt):n.examEndsAt}))})}formInvalid(){return this.markFormGroupAsTouched(this.examSearchForm),this.showRequiredErrorMessage(this.examSearchForm,this.required_field),this.examSearchForm.invalid}fetchConfiguration(){this.subscribers.confSubs=this.adminService.fetchConfiguration().subscribe(t=>{t.result&&(this.examLevelOptions=t.data.examLevelList,this.sessionOptions=t.data.examSessionList,this.yearOptions=t.data.examYearList)})}clearExamList(t){this.examList=[]}onExamLevelClear(){this.examList=[]}save(t){let n=this.prepareSchedule(t);this.dateValidated(n)?this.ExamSchedulingService.saveSchedule([n]).subscribe(a=>{a.result&&this.messageService.add({summary:"Saved",detail:"Exam Schedule Updated",severity:"success"})}):t.invalidEndDate=!0}dateValidated(t){let n=new Date(t.examStartsAt),a=new Date(t.examEndsAt),i=n.getTime()<a.getTime();return i||this.messageService.add({summary:"Invalid Time",detail:"Start Time cannot be greater than End Time",severity:"error"}),i}prepareSchedule(t){let n=new d;return n.id=t.id,n.examDate=t.examDate,n.examStartsAt=t.examStartsAt?this.changeDate(t.examStartsAt,n.examDate):null,n.examEndsAt=t.examEndsAt?this.changeDate(t.examEndsAt,n.examDate):null,n.quizPwd=t.quizPwd,n.examDate=this.datePipe.transform(n.examDate,"yyyy-MM-dd"),n}changeDate(t,n){return n=new Date(n),new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(m.F0),e.Y36(m.gz),e.Y36(p.ez),e.Y36(D),e.Y36(L.l),e.Y36(l.qu),e.Y36(C.uU))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-exam-scheduling"]],features:[e.qOj],decls:25,vars:10,consts:[[1,"grid"],[1,"col-12","md:col-12"],[1,"card","p-fluid"],[1,"p-5",3,"formGroup"],[1,"formgrid","grid"],[1,"field","col"],["for","exam-level"],["id","exam-level","formControlName","examLevel","placeholder","Select Exam Level","optionLabel","name","optionValue","code",3,"showClear","options","onChange","onClear"],["for","session"],["id","session","placeholder","Select Session","formControlName","session","optionLabel","name","optionValue","code",3,"showClear","options","onChange"],["for","year"],["id","year","placeholder","Select Year","formControlName","year","optionLabel","name","optionValue","code",3,"showClear","options","onChange"],[1,"flex","justify-content-end"],["icon","pi pi-search","label","Find",3,"onClick"],[1,"mt-5"],[3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[1,"justify-content-center"],["placeholder","Date","appendTo","body","dateFormat","dd-M-yy",3,"ngModel","showIcon","ngModelChange"],["id","startAt","name","startAt","placeholder","Start Time","appendTo","body","dateFormat","dd-M-yy",3,"ngModel","timeOnly","ngModelChange"],["id","endsAt","name","endsAt","placeholder","End Time","appendTo","body","dateFormat","dd-M-yy",3,"ngModel","timeOnly","ngModelChange"],[3,"ngModel","feedback","toggleMask","ngModelChange"],["icon","pi pi-save","label","Save",3,"rounded","text","onClick"]],template:function(n,a){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),e._uU(4,"Schedule Exam"),e.qZA(),e.TgZ(5,"form",3)(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Exam Level"),e.qZA(),e.TgZ(10,"p-dropdown",7),e.NdJ("onChange",function(s){return a.clearExamList(s.value)})("onClear",function(){return a.onExamLevelClear()}),e.qZA()(),e.TgZ(11,"div",5)(12,"label",8),e._uU(13,"Session"),e.qZA(),e.TgZ(14,"p-dropdown",9),e.NdJ("onChange",function(s){return a.clearExamList(s.value)}),e.qZA()(),e.TgZ(15,"div",5)(16,"label",10),e._uU(17,"Year"),e.qZA(),e.TgZ(18,"p-dropdown",11),e.NdJ("onChange",function(s){return a.clearExamList(s.value)}),e.qZA()()(),e.TgZ(19,"div",12)(20,"p-button",13),e.NdJ("onClick",function(){return a.searchExams()}),e.qZA()()(),e.TgZ(21,"div",14)(22,"p-table",15),e.YNc(23,F,13,0,"ng-template",16),e.YNc(24,b,14,14,"ng-template",17),e.qZA()()()()()),2&n&&(e.xp6(5),e.Q6J("formGroup",a.examSearchForm),e.xp6(5),e.Q6J("showClear",!0)("options",a.examLevelOptions),e.xp6(4),e.Q6J("showClear",!0)("options",a.sessionOptions),e.xp6(4),e.Q6J("showClear",!0)("options",a.yearOptions),e.xp6(4),e.Q6J("value",a.examList)("tableStyle",e.DdM(9,J)))},dependencies:[l._Y,l.JJ,l.JL,l.sg,l.u,l.On,v.Lt,p.jx,f.zx,S.iA,E.f,T.ro]})}return o})()}];var w=r(3714);let U=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(Y),l.UX,l.u5,C.ez,v.kW,f.hJ,S.U$,E._8,w.j,T.gz]})}return o})()},6792:(M,c,r)=>{r.d(c,{l:()=>x});var m=r(3792);const h=r(1108)._+"/get-configuration-data";var g=r(9291);let x=(()=>{class d extends m.b{constructor(){super()}fetchConfiguration(){return this.http.get(h)}static#e=this.\u0275fac=function(u){return new(u||d)};static#t=this.\u0275prov=g.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);